/**
 * jQuery Form Validation
 *
 * @author Tom Bertrand
 * @version 1.3.5 (2014-09-10)
 *
 * @copyright
 * Copyright (C) 2014 RunningCoder.
 *
 * @link
 * http://www.runningcoder.org/jqueryvalidation/
 *
 * @license
 * Licensed under the MIT license.
 */
(function(window,document,$,undefined){window.Validation={form:[],messages:null,labels:{},hasScrolled:false};if(typeof Object.preventExtensions!=="function"){Object.preventExtensions=function(e){return e}}var _rules={NOTEMPTY:/./,NUMERIC:/^[0-9]+$/,MIXED:/^[\w\s-]+$/,NOSPACE:/^[^\s]+$/,TRIM:/^[^\s].*[^\s]$/,DATE:/^\d{4}-\d{2}-\d{2}(\s\d{2}:\d{2}(:\d{2})?)?$/,EMAIL:/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i,URL:/^(https?:\/\/)?((([a-z0-9]-*)*[a-z0-9]+\.?)*([a-z0-9]+))(\/[\w?=\.-]*)*$/,PHONE:/^(\()?\d{3}(\))?(-|\s)?\d{3}(-|\s)\d{4}$/,OPTIONAL:/^.*$/,COMPARISON:/^\s*([LV])\s*([<>]=?|==|!=)\s*([^<>=!]+?)\s*$/};var _messages=Object.preventExtensions({"default":"$ contain error(s).",NOTEMPTY:"$ must not be empty.",NUMERIC:"$ must be numeric.",STRING:"$ must be a string.",NOSPACE:"$ must not contain spaces.",TRIM:"$ must not start or end with space character.",MIXED:"$ must be letters or numbers (no special characters).",DATE:"$ is not a valid with format YYYY-MM-DD.",EMAIL:"$ is not valid.",URL:"$ is not valid.",PHONE:"$ is not a valid phone number.","<":"$ must be less than % characters.","<=":"$ must be less or equal to % characters.",">":"$ must be greater than % characters.",">=":"$ must be greater or equal to % characters.","==":"$ must be equal to %","!=":"$ must be different than %"}),_extendedMessages=false;var _data={validation:"data-validation",validationMessage:"data-validation-message",regex:"data-validation-regex",regexMessage:"data-validation-regex-message",group:"data-validation-group",label:"data-validation-label",errorList:"data-error-list"};var _options={submit:{settings:{form:null,display:"inline",insertion:"append",allErrors:false,trigger:"click",button:"input[type='submit']",errorClass:"error",errorListClass:"error-list",inputContainer:null,clear:"focusin",scrollToError:false},callback:{onInit:null,onValidate:null,onError:null,onBeforeSubmit:null,onSubmit:null,onAfterSubmit:null}},dynamic:{settings:{trigger:null,delay:300},callback:{onSuccess:null,onError:null,onComplete:null}},messages:{},labels:{},debug:false};var _supported={submit:{settings:{display:["inline","block"],insertion:["append","prepend"],allErrors:[true,false],clear:["focusin","keypress",false],trigger:["click","dblclick","focusout","hover","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","toggle"]}},dynamic:{settings:{trigger:["focusout","keydown","keypress","keyup"]}},debug:[true,false]};var Validation=function(node,options){function extendMessages(){if(!window.Validation.messages||_extendedMessages){return false}_messages=$.extend(_messages,window.Validation.messages);_extendedMessages=true}function extendOptions(){if(!(options instanceof Object)){options={}}var e=Object.preventExtensions($.extend(true,{},_options)),t=Object.preventExtensions($.extend(true,{},_messages));e.messages=$.extend(t,options.messages||{});for(var n in options){if(!options.hasOwnProperty(n)||n==="debug"||n==="messages"){continue}if(n==="labels"&&options[n]instanceof Object){e[n]=options[n];continue}if(!_options[n]||!(options[n]instanceof Object)){continue}for(var r in options[n]){if(!options[n].hasOwnProperty(r)){continue}if(!_options[n][r]||!(options[n][r]instanceof Object)){continue}for(var i in options[n][r]){if(!options[n][r].hasOwnProperty(i)){continue}if(_supported[n]&&_supported[n][r]&&_supported[n][r][i]&&$.inArray(options[n][r][i],_supported[n][r][i])===-1){delete options[n][r][i]}}if(e[n]&&e[n][r]){e[n][r]=$.extend(Object.preventExtensions(e[n][r]),options[n][r])}}}if(e.dynamic.settings.trigger){if(e.dynamic.settings.trigger==="keypress"&&e.submit.settings.clear==="keypress"){e.dynamic.settings.trigger="keydown"}}options=e}function delegateDynamicValidation(){if(!options.dynamic.settings.trigger){return false}if(!$(node).find("["+_data.validation+"],["+_data.regex+"]")[0]){return false}var e=".vd",t=options.dynamic.settings.trigger+e;if(options.dynamic.settings.trigger!=="focusout"){t+=" change"+e+" paste"+e}$.each($(node).find("["+_data.validation+"],["+_data.regex+"]"),function(e,n){$(n).unbind(t).on(t,function(e){if($(this).is(":disabled")){return false}var t=this,n=e.keyCode||null;_typeWatch(function(){if(!validateInput(t)){displayOneError(t.name);_executeCallback(options.dynamic.callback.onError,[node,t,n,errors[t.name]])}else{_executeCallback(options.dynamic.callback.onSuccess,[node,t,n])}_executeCallback(options.dynamic.callback.onComplete,[node,t,n])},options.dynamic.settings.delay)})})}function delegateValidation(){_executeCallback(options.submit.callback.onInit,[node]);var e=options.submit.settings.trigger+".vd";if(!$(node).find(options.submit.settings.button)[0]){return false}$(node).on("submit",false);$(node).find(options.submit.settings.button).unbind(e).on(e,function(e){e.preventDefault();resetErrors();_executeCallback(options.submit.callback.onValidate,[node]);if(!validateForm()){_executeCallback(options.submit.callback.onError,[node,errors]);displayErrors()}else{_executeCallback(options.submit.callback.onBeforeSubmit,[node]);options.submit.callback.onSubmit?_executeCallback(options.submit.callback.onSubmit,[node]):submitForm();_executeCallback(options.submit.callback.onAfterSubmit,[node])}return false})}function validateForm(){var e=true;$.each($(node).find("["+_data.validation+"],["+_data.regex+"]"),function(t,n){if($(this).is(":disabled")){return false}if(!validateInput(n)){e=false}});return e}function validateInput(e){var t=$(e).attr("name");if(!t){return false}var n=_getInputValue(e),r=t.replace(/]$/,"").split(/]\[|[[\]]/g),i=window.Validation.labels[t]||options.labels[t]||$(e).attr(_data.label)||r[r.length-1],s=$(e).attr(_data.validation),o=$(e).attr(_data.validationMessage),u=$(e).attr(_data.regex),a=$(e).attr(_data.regexMessage),f=false;if(s){s=_api._splitValidation(s)}if(s instanceof Array&&s.length>0){if(n===""&&$.inArray("OPTIONAL",s)!==-1){return true}$.each(s,function(e,r){if(f===true){return true}try{validateRule(n,r)}catch(s){if(o||!options.submit.settings.allErrors){f=true}s[0]=o||s[0];registerError(t,s[0].replace("$",i).replace("%",s[1]))}})}if(u){var l=u.split("/");if(l.length>1){var c="";for(var h=0;h<l.length-1;h++){if(l[h]!==""){c+=l[h]+"/"}}c=c.slice(0,-1);if(/[gimsxeU]+/.test(l[l.length-1])){var p=l[l.length-1]}l=c}else{l=l[0]}try{var d=new RegExp(l,p)}catch(v){return true}try{validateRule(n,d)}catch(v){v[0]=a||v[0];registerError(t,v[0].replace("$",i))}}return!errors[t]||errors[t]instanceof Array&&errors[t].length===0}function validateRule(value,rule){if(rule instanceof RegExp){if(rule.test(value)){throw[options.messages["default"],""]}return}if(_rules[rule]){if(!_rules[rule].test(value)){throw[options.messages[rule],""]}return}var comparison=rule.match(_rules["COMPARISON"]);if(!comparison||comparison.length!==4){return}var type=comparison[1],operator=comparison[2],compared=comparison[3],comparedValue;switch(type){case"L":if(isNaN(compared)){return false}else{if(!value||eval(value.length+operator+parseFloat(compared))==false){throw[options.messages[operator],compared]}}break;case"V":default:if(isNaN(compared)){comparedValue=$(node).find('[name="'+compared+'"]').val();if(!comparedValue){return false}if(!value||!eval('"'+encodeURIComponent(value)+'"'+operator+'"'+encodeURIComponent(comparedValue)+'"')){throw[options.messages[operator].replace(" characters",""),compared]}}else{if(!value||isNaN(value)||!eval(value+operator+parseFloat(compared))){throw[options.messages[operator].replace(" characters",""),compared]}}break}}function registerError(e,t){if(!errors[e]){errors[e]=[]}t=t.capitalize();var n=false;for(var r=0;r<errors[e].length;r++){if(errors[e][r]===t){n=true;break}}if(!n){errors[e].push(t)}}function displayOneError(e){var t,n,r,i,s='<div class="'+options.submit.settings.errorListClass+'" '+_data.errorList+"><ul></ul></div>",o,u;if(!errors.hasOwnProperty(e)){return false}t=$(node).find('[name="'+e+'"]');i=null;if(!t[0]){return false}o=t.attr(_data.group);if(o){u=$(node).find('[name="'+e+'"]');i=$(node).find('[id="'+o+'"]');if(i[0]){i.addClass(options.submit.settings.errorClass);r=i}}else{t.addClass(options.submit.settings.errorClass);if(options.submit.settings.inputContainer){t.parentsUntil(node,options.submit.settings.inputContainer).addClass(options.submit.settings.errorClass)}n=t.attr("id");if(n){i=$(node).find('label[for="'+n+'"]')[0]}if(!i){i=t.parentsUntil(node,"label")[0]}if(i){i=$(i);i.addClass(options.submit.settings.errorClass)}}if(options.submit.settings.display==="inline"){r=r||t.parent()}else if(options.submit.settings.display==="block"){r=$(node)}if(options.submit.settings.display==="inline"&&r.find("["+_data.errorList+"]")[0]){return false}if(options.submit.settings.display==="inline"||options.submit.settings.display==="block"&&!r.find("["+_data.errorList+"]")[0]){if(options.submit.settings.insertion==="append"){r.append(s)}else if(options.submit.settings.insertion==="prepend"){r.prepend(s)}}for(var a=0;a<errors[e].length;a++){r.find("ul").append("<li>"+errors[e][a]+"</li>")}if(options.submit.settings.clear||options.dynamic.settings.trigger){if(o&&u){t=u}var f=".vr",l="coucou"+f;if(options.submit.settings.clear){l+=" "+options.submit.settings.clear+f}if(options.dynamic.settings.trigger){l+=" "+options.dynamic.settings.trigger+f;if(options.dynamic.settings.trigger!=="focusout"){l+=" change"+f+" paste"+f}}t.unbind(l).on(l,function(e,t,n,r,i){return function(){if(i){if($(n).hasClass(options.submit.settings.errorClass)){resetOneError(e,t,n,r,i)}}else if($(t).hasClass(options.submit.settings.errorClass)){resetOneError(e,t,n,r)}}}(e,t,i,r,o))}if(options.submit.settings.scrollToError&&!window.Validation.hasScrolled){window.Validation.hasScrolled=true;var c=parseFloat(options.submit.settings.scrollToError.offset)||0,h=parseFloat(options.submit.settings.scrollToError.duration)||500,p=options.submit.settings.display==="block"?r:t;$("html, body").animate({scrollTop:p.offset().top+c},h)}}function displayErrors(){for(var e in errors){displayOneError(e)}}function resetOneError(e,t,n,r,i){delete errors[e];if(r){if(options.submit.settings.inputContainer){(i?n:t).parentsUntil(node,options.submit.settings.inputContainer).removeClass(options.submit.settings.errorClass)}n&&n.removeClass(options.submit.settings.errorClass);t.removeClass(options.submit.settings.errorClass);if(options.submit.settings.display==="inline"){r.find("["+_data.errorList+"]").remove()}}else{if(!t){t=$(node).find('[name="'+e+'"]');if(!t[0]){return false}}t.trigger("coucou.vr")}}function resetErrors(){errors=[];window.Validation.hasScrolled=false;$(node).find("["+_data.errorList+"]").remove();$(node).find("."+options.submit.settings.errorClass).removeClass(options.submit.settings.errorClass)}function submitForm(){node.submit()}var errors=[];window.Validation.hasScrolled=false;var _typeWatch=function(){var e=0;return function(t,n){clearTimeout(e);e=setTimeout(t,n)}}();var _getInputValue=function(e){var t;switch($(e).attr("type")){case"checkbox":t=$(e).is(":checked")?1:"";break;case"radio":t=$(node).find('input[name="'+$(e).attr("name")+'"]:checked').val()||"";break;default:t=$(e).val();break}return t};var _executeCallback=function(e,t){if(!e){return false}var n;if(typeof e==="function"){n=e}else if(typeof e==="string"||e instanceof Array){n=window;if(typeof e==="string"){e=[e,[]]}var r=e[0].split("."),i=e[1],s=true,o=0;while(o<r.length){if(typeof n!=="undefined"){n=n[r[o++]]}else{s=false;break}}if(!s||typeof n!=="function"){return false}}n.apply(this,$.merge(i||[],t?t:[]));return true};this.__construct=function(){extendMessages();extendOptions();delegateDynamicValidation();delegateValidation()}();return{registerError:registerError,displayOneError:displayOneError,displayErrors:displayErrors,resetOneError:resetOneError,resetErrors:resetErrors}};$.fn.validate=$.validate=function(e){return _api.validate(this,e)};$.fn.addValidation=function(e){return _api.addValidation(this,e)};$.fn.removeValidation=function(e){return _api.removeValidation(this,e)};$.fn.addError=function(e){return _api.addError(this,e)};$.fn.removeError=function(e){return _api.removeError(this,e)};var _api={_formatValidation:function(e){e=e.toString().replace(/\s/g,"");if(e.charAt(0)==="["&&e.charAt(e.length-1)==="]"){e=e.replace(/^\[|\]$/g,"")}return e},_splitValidation:function(e){var t=this._formatValidation(e).split(","),n;for(var r=0;r<t.length;r++){n=t[r];if(/^[a-z]+$/i.test(n)){t[r]=n.toUpperCase()}}return t},_joinValidation:function(e){return"["+e.join(", ")+"]"},validate:function(e,t){if(typeof e==="function"){if(!t.submit.settings.form){return}e=$(t.submit.settings.form);if(!e[0]){return}}else if(typeof e[0]==="undefined"){return}return e.each(function(){window.Validation.form[e.selector]=new Validation(this,t)})},addValidation:function(e,t){var n=this;t=n._splitValidation(t);if(!t){return false}return e.each(function(){var e=$(this),r=e.attr(_data.validation),i=r&&r.length?n._splitValidation(r):[],s;for(var o=0;o<t.length;o++){s=n._formatValidation(t[o]);if($.inArray(s,i)===-1){i.push(s)}}if(i.length){e.attr(_data.validation,n._joinValidation(i))}})},removeValidation:function(e,t){var n=this;t=n._splitValidation(t);if(!t){return false}return e.each(function(){var e=$(this),r=e.attr(_data.validation),i=r&&r.length?n._splitValidation(r):[],s,o;if(!i.length){e.removeAttr(_data.validation);return true}for(var u=0;u<t.length;u++){s=n._formatValidation(t[u]);o=$.inArray(s,i);if(o!==-1){i.splice(o,1)}}if(!i.length){e.removeAttr(_data.validation);return true}e.attr(_data.validation,n._joinValidation(i))})},addError:function(e,t){if(!window.Validation.form[e.selector]){return false}if(typeof t!=="object"||Object.prototype.toString.call(t)!=="[object Object]"){return false}var n,r=true;for(var i in t){if(!t.hasOwnProperty(i)){continue}if(!(t[i]instanceof Array)){t[i]=[t[i]]}n=$(e.selector).find('[name="'+i+'"]');if(!n[0]){continue}if(r){window.Validation.hasScrolled=false;r=false}window.Validation.form[e.selector].resetOneError(i,n);for(var s=0;s<t[i].length;s++){if(typeof t[i][s]!=="string"){continue}window.Validation.form[e.selector].registerError(i,t[i][s])}window.Validation.form[e.selector].displayOneError(i)}},removeError:function(e,t){if(!window.Validation.form[e.selector]){return false}if(!t){window.Validation.form[e.selector].resetErrors();return false}if(typeof t==="object"&&Object.prototype.toString.call(t)!=="[object Array]"){return false}if(!(t instanceof Array)){t=[t]}var n;for(var r=0;r<t.length;r++){n=$(e.selector).find('[name="'+t[r]+'"]');if(!n[0]){continue}window.Validation.form[e.selector].resetOneError(t[r],n)}}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};window.JSON.stringify=JSON.stringify||function(e){var t=typeof e;if(t!=="object"||e===null){if(t==="string"){e='"'+e+'"'}return String(e)}else{var n,r,i=[],s=e&&e.constructor===Array;for(n in e){if(true){r=e[n];t=typeof r;if(t==="string"){r='"'+r+'"'}else if(t==="object"&&r!==null){r=JSON.stringify(r)}i.push((s?"":'"'+n+'": ')+String(r))}}return(s?"[":"{")+String(i)+(s?"]":"}")}}})(window,document,window.jQuery)